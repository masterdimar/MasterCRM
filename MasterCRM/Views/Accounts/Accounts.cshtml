@model MasterCRM.Models.AccountsViewModel

@{
    ViewBag.Title = "Accounts";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<section class="content-header">
    <h1>
        Accounts
    </h1>
    <ol class="breadcrumb">
        <li><a href="#"><i class="fa fa-building"></i> Accounts</a></li>
    </ol>
</section>

<!-- Main content -->
<section class="content">
    <!-- Your Page Content Here -->
    <div class="box">
        <div class="box-header">
            <div>
                <div style="width: 80%; float:left">
                    <button style="width: 50px" type="button" class="btn btn-block btn-default btn-sm">New</button>
                </div>
                <div style="width: 20%; float:right; text-align:right">
                    <a href="#" data-toggle="control-sidebar"><i class="fa fa-filter"></i></a>
                </div>
            </div>
        </div>
        <!-- /.box-header -->
        <div class="box-body">
            <table id="tabAccounts" class="table table-bordered table-hover">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Type</th>
                        <th>Web</th>
                        <th>Sector</th>
                        <th>Owner</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
        <!-- /.box-body -->
    </div>
    <!-- /.box -->
</section>


<!-- Control Sidebar -->
<aside class="control-sidebar control-sidebar-dark sidebar-collapse">
    <!-- Create the tabs -->
    <ul class="nav nav-tabs nav-justified control-sidebar-tabs">
        <li class="active"><a href="#control-sidebar-home-tab" data-toggle="tab"><i class="fa fa-filter"></i></a></li>
    </ul>
    <!-- Tab panes -->
    <div class="tab-content">
        <!-- Home tab content -->
        <div class="tab-pane active" id="control-sidebar-home-tab">
            <!-- /.control-sidebar-menu -->
            <h3 class="control-sidebar-heading">Accounts Filters</h3>
            <ul class="control-sidebar-menu">
                <li>
                    <form role="form" style="padding-right: 2px; padding-left: 2px">
                        <div class="form-group">
                            <label>Name</label>
                            <input id="txtName" type="text" class="form-control" placeholder="Enter ...">
                        </div>
                        <div class="form-group">
                            <label>Type</label>
                            @Html.DropDownList("ddlAccountType", new SelectList((System.Collections.IEnumerable)ViewData["AccountTypes"], "TipoCuentaID", "Descripcion"), new { @class = "form-control", @multiple = "" })
                        </div>
                        <div class="form-group">
                            <label>Web</label>
                            <input id="txtWeb" type="text" class="form-control" placeholder="Enter ...">
                        </div>
                        <div class="form-group">
                            <label>Sector</label>
                            @Html.DropDownList("ddlAccountSector", new SelectList((System.Collections.IEnumerable)ViewData["AccountSectors"], "SectorCuentaID", "Descripcion"), new { @class = "form-control", @multiple = "" })
                        </div>
                        <div class="form-group">
                            <label>Owner</label>
                            <input id="txtOwner" type="text" class="form-control" placeholder="Enter ...">
                        </div>
                    </form>
                </li>
                <br />
                <li>
                    <form role="form" style="padding-right: 2px; padding-left: 2px">
                        <div class="form-group">
                            <div class="btn-group btn-group-justified blocks">
                                <a class="btn btn-default" data-toggle="control-sidebar" onclick="FiltrarGrilla()">
                                    <i class="fa fa-filter"> Filter</i>
                                </a>
                                <a class="btn btn-default" onclick="Reset()">
                                    <i class="fa fa-eraser"> Reset</i>   
                                </a>
                                <a class="btn btn-default" data-toggle="control-sidebar">
                                    <i class="fa fa-close"> Close</i>                                    
                                </a>
                            </div>
                        </div>
                    </form>
                </li>
            </ul>            
            <!-- /.control-sidebar-menu -->

        </div>
        <!-- /.tab-pane -->
    </div>
</aside>
<!-- /.control-sidebar -->
<!-- Add the sidebar's background. This div must be placed
     immediately after the control sidebar -->
<div class="control-sidebar-bg"></div>

<script>
    $(function () {
        tabAccounts = $('#tabAccounts').DataTable({
            "bProcessing": true,
            "sAjaxSource": '@Url.Action("GetAccounts", "Accounts")',
            "iDisplayLength": 10,
            "bFilter": false,
            "sServerMethod": "POST",
            "bServerSide": true,
            "sDom": '<"responsive_scroll"t><"row-fluid" <"span4"l><"span3"i><"span5"p>>',
            "aaSorting": [[0, "desc"]],
            "aoColumns": [
                            { "mDataProp": "Nombre" },
                            { "mDataProp": "TipoCuentaDescripcion" },
                            { "mDataProp": "Web" },
                            { "mDataProp": "SectorCuentaDescripcion" },
                            { "mDataProp": "Owner" }
            ],
            "fnServerParams": function (aoData) {
                aoData.push({ "name": "AccountName", "value": $("#txtName").val() });
                aoData.push({ "name": "AccountType", "value": $("#ddlAccountType").val() });
                aoData.push({ "name": "AccountSector", "value": $("#ddlAccountSector").val() });
                aoData.push({ "name": "Web", "value": $("#txtWeb").val() });
                aoData.push({ "name": "Owner", "value": $("#txtOwner").val() });
            }
        });
    });

    function FiltrarGrilla() {
        tabAccounts.ajax.reload();
    }

    function Reset()
    {
        $("#txtName").val("");
        $("#ddlAccountType").val("");
        $("#ddlAccountSector").val("");
        $("#txtWeb").val("");
        $("#txtOwner").val("");
    }
</script>